<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bell Timer</title>

  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }

    body {
      margin: 0;
      height: 100vh;
      background: linear-gradient(-45deg, #0b2a5b, #b91c1c, #0b2a5b, #1e3a8a);
      background-size: 400% 400%;
      animation: bgMove 20s ease infinite;
      color: #0f172a;
    }

    @keyframes bgMove {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .wrap {
      height: 100vh;
      display: grid;
      place-items: center;
      padding: 16px;
      box-sizing: border-box;
    }

    .card {
      width: min(1600px, 99vw);
      background: rgba(255,255,255,0.92);
      border-radius: 28px;
      box-shadow: 0 30px 60px rgba(0,0,0,0.35);
      padding: 18px;
      display: grid;
      gap: 12px;
      box-sizing: border-box;
    }

    .top {
      display: grid;
      grid-template-columns: 280px 1fr 280px;
      gap: 14px;
      align-items: stretch;
    }

    .logoTile,
    .periodTile {
      background: linear-gradient(180deg, #f8fafc, #eef2ff);
      border-radius: 22px;
      box-shadow:
        inset 0 0 0 1px rgba(15,23,42,0.06),
        0 14px 30px rgba(15,23,42,0.15);
      padding: 16px;
      display: grid;
      place-items: center;
      min-height: 340px;
      text-align: center;
    }

    .logoTile img {
      height: 190px;
      max-width: 100%;
      filter: drop-shadow(0 10px 22px rgba(0,0,0,0.35));
    }

    .timerCard {
      background: linear-gradient(180deg, #f8fafc, #eef2ff);
      border-radius: 26px;
      box-shadow:
        inset 0 0 0 1px rgba(15,23,42,0.06),
        0 18px 36px rgba(15,23,42,0.18);
      padding: 22px 34px;
      display: grid;
      place-items: center;
      text-align: center;
      min-height: 340px;
    }

    .timerLabel {
      font-size: 22px;
      color: #1e293b;
      letter-spacing: 0.02em;
    }

    .timerValue {
      font-size: clamp(160px, 13vw, 260px);
      font-weight: 950;
      line-height: 0.92;
      color: #0b2a5b;
      text-shadow: 0 10px 22px rgba(11,42,91,0.35);
      animation: pulse 1.5s ease-in-out infinite;
    }

    .timerSub {
      font-size: 30px;
      color: #334155;
      word-break: break-word;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.015); }
      100% { transform: scale(1); }
    }

    .periodLabel {
      font-size: 20px;
      color: #1e293b;
      letter-spacing: 0.02em;
    }

    .periodValue {
      font-size: 72px;
      font-weight: 950;
      line-height: 1;
      color: #0b2a5b;
      text-shadow: 0 6px 16px rgba(11,42,91,0.30);
    }

    .periodRange {
      text-align: center;
      font-size: 22px;
      color: #334155;
      padding: 4px 10px;
    }

    .bottomBar {
      display: flex;
      justify-content: center;
      padding-top: 8px;
      border-top: 1px solid rgba(15,23,42,0.12);
    }

    .switchBtn {
      font-size: 15px;
      padding: 10px 18px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-weight: 800;
      background: linear-gradient(135deg, #0b2a5b, #1e40af);
      color: white;
      box-shadow: 0 6px 14px rgba(0,0,0,0.18);
    }

    .switchBtn:active { transform: scale(0.97); }

    @media (max-width: 1100px) {
      .top { grid-template-columns: 1fr; }
      .logoTile img { height: 150px; }
      .timerValue { font-size: clamp(140px, 20vw, 220px); }
      .logoTile, .periodTile, .timerCard { min-height: 260px; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">

      <div class="top">
        <div class="logoTile">
          <img src="HSATigerCircleSPIRIT.png" alt="Harmony Science Academy Tigers">
        </div>

        <div class="timerCard">
          <div class="timerLabel">Time remaining</div>
          <div class="timerValue" id="remainingValue">--:--</div>
          <div class="timerSub" id="nextBellValue"></div>
        </div>

        <div class="periodTile">
          <div class="periodLabel">Period</div>
          <div class="periodValue" id="periodValue"></div>
        </div>
      </div>

      <div class="periodRange" id="periodRange"></div>

      <div class="bottomBar">
        <button class="switchBtn" id="switchBtn"></button>
      </div>

    </div>
  </div>

  <script>
    const toMin = (h, m) => h * 60 + m;

    const schedules = {
      "1": {
        "mon_thurs": [
          { start: toMin(7,36), end: toMin(8,33), period: 1 },
          { start: toMin(8,37), end: toMin(9,34), period: 2 },
          { start: toMin(9,38), end: toMin(10,35), period: 3 },
          { start: toMin(10,39), end: toMin(11,36), period: 4 },
          { start: toMin(11,40), end: toMin(12,10), period: 5 },
          { start: toMin(12,14), end: toMin(13,11), period: 6 },
          { start: toMin(13,15), end: toMin(14,12), period: 7 },
          { start: toMin(14,16), end: toMin(15,13), period: 8 }
        ],
        "fri": [
          { start: toMin(7,36), end: toMin(8,14), period: 1 },
          { start: toMin(8,18), end: toMin(8,56), period: 2 },
          { start: toMin(9,0),  end: toMin(9,38), period: 3 },
          { start: toMin(9,42), end: toMin(10,20), period: 4 },
          { start: toMin(10,24), end: toMin(10,54), period: 5 },
          { start: toMin(10,58), end: toMin(11,36), period: 6 },
          { start: toMin(11,40), end: toMin(12,18), period: 7 },
          { start: toMin(12,22), end: toMin(13,0),  period: 8 }
        ]
      },
      "2": {
        "mon_thurs": [
          { start: toMin(7,36), end: toMin(8,33), period: 1 },
          { start: toMin(8,37), end: toMin(9,34), period: 2 },
          { start: toMin(9,38), end: toMin(10,35), period: 3 },
          { start: toMin(10,39), end: toMin(11,36), period: 4 },
          { start: toMin(11,40), end: toMin(12,37), period: 5 },
          { start: toMin(12,41), end: toMin(13,11), period: 6 },
          { start: toMin(13,15), end: toMin(14,12), period: 7 },
          { start: toMin(14,16), end: toMin(15,13), period: 8 }
        ],
        "fri": [
          { start: toMin(7,36), end: toMin(8,14), period: 1 },
          { start: toMin(8,18), end: toMin(8,56), period: 2 },
          { start: toMin(9,0),  end: toMin(9,38), period: 3 },
          { start: toMin(9,42), end: toMin(10,20), period: 4 },
          { start: toMin(10,24), end: toMin(11,2),  period: 5 },
          { start: toMin(11,6),  end: toMin(11,36), period: 6 },
          { start: toMin(11,40), end: toMin(12,18), period: 7 },
          { start: toMin(12,22), end: toMin(13,0),  period: 8 }
        ]
      }
    };

    const el = (id) => document.getElementById(id);
    const switchBtn = el("switchBtn");

    let building = localStorage.getItem("bell_building") || "2";

    function pad(n){ return String(n).padStart(2, "0"); }

    function formatTime(mins){
      const h = Math.floor(mins / 60);
      const m = mins % 60;
      const ampm = h >= 12 ? "PM" : "AM";
      const hh = ((h + 11) % 12) + 1;
      return `${hh}:${pad(m)} ${ampm}`;
    }

    function getDayKey(){
      const d = new Date().getDay();
      return d === 5 ? "fri" : "mon_thurs";
    }

    function nowMinutes(){
      const n = new Date();
      return n.getHours() * 60 + n.getMinutes() + n.getSeconds() / 60;
    }

    function findActive(blocks, nowM){
      for (let i = 0; i < blocks.length; i++) {
        if (nowM >= blocks[i].start && nowM < blocks[i].end) return i;
      }
      return -1;
    }

    function nextBlockIndex(blocks, nowM){
      for (let i = 0; i < blocks.length; i++) {
        if (nowM < blocks[i].start) return i;
      }
      return -1;
    }

    function updateButton(){
      switchBtn.textContent = building === "2" ? "Building 1" : "Building 2";
    }

    switchBtn.onclick = () => {
      building = building === "2" ? "1" : "2";
      localStorage.setItem("bell_building", building);
      updateButton();
      tick();
    };

    function setDisplay(stateLabel, rangeText, secondsLeft, nextBellText){
      el("periodValue").textContent = stateLabel;
      el("periodRange").textContent = rangeText;
      el("remainingValue").textContent = `${Math.floor(secondsLeft / 60)}:${pad(secondsLeft % 60)}`;
      el("nextBellValue").textContent = nextBellText;
    }

    function tick(){
      const dayKey = getDayKey();
      const blocks = schedules[building][dayKey];
      const nowM = nowMinutes();

      const activeIdx = findActive(blocks, nowM);

      // In a period
      if (activeIdx >= 0) {
        const b = blocks[activeIdx];
        const secondsLeft = Math.max(0, Math.floor((b.end - nowM) * 60));
        setDisplay(
          `P ${b.period}`,
          `${formatTime(b.start)} to ${formatTime(b.end)}`,
          secondsLeft,
          `Next bell at ${formatTime(b.end)}`
        );
        return;
      }

      // Before school
      if (nowM < blocks[0].start) {
        const secondsLeft = Math.max(0, Math.floor((blocks[0].start - nowM) * 60));
        setDisplay(
          "Before School",
          `First bell at ${formatTime(blocks[0].start)}`,
          secondsLeft,
          `Next bell at ${formatTime(blocks[0].start)}`
        );
        return;
      }

      // Transition (between periods)
      for (let i = 0; i < blocks.length - 1; i++) {
        if (nowM >= blocks[i].end && nowM < blocks[i + 1].start) {
          const secondsLeft = Math.max(0, Math.floor((blocks[i + 1].start - nowM) * 60));
          setDisplay(
            "Transition",
            `Next: P ${blocks[i + 1].period}`,
            secondsLeft,
            `Next bell at ${formatTime(blocks[i + 1].start)}`
          );
          return;
        }
      }

      // After school
      setDisplay(
        "After School",
        "Schedule finished",
        0,
        "No more bells today"
      );
    }

    updateButton();
    tick();
    setInterval(tick, 1000);
  </script>
</body>
</html>
